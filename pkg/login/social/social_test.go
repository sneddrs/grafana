package social

import (
	"testing"

	"github.com/stretchr/testify/require"
)

func TestReadingSimpleGroupMappingSettings(t *testing.T) {
	config, err := readConfig("testdata/simple.toml")
	require.NoError(t, err)
	require.Len(t, config.GroupMappings, 1)
	require.Equal(t, "role", config.GroupMappings[0].RoleAttributePath)
}

func TestReadingFullGroupMappingSettings(t *testing.T) {
	config, err := readConfig("testdata/full.toml")
	require.NoError(t, err)
	require.Len(t, config.GroupMappings, 3)
	require.Equal(t, "contains(info.groups[*], 'admin') && 'Admin'", config.GroupMappings[0].RoleAttributePath)
	require.True(t, *config.GroupMappings[0].IsGrafanaAdmin)
}
